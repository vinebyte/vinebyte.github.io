<!DOCTYPE html>
<html>
<head>
  <title>生成二维码</title>
  <script src="https://cdn.jsdelivr.net/npm/qrcode-generator/qrcode.js"></script>
</head>
<body>
  <input type="text" id="refInput" placeholder="请输入ref信息">
  <button onclick="generateQRCode()">生成二维码海报</button>
  <br><br>
  <canvas id="qrCodeCanvas" width="1560" height="1289"></canvas>

  <script>
    function generateQRCode() {
  const refInput = document.getElementById('refInput');
  const ref = refInput.value;
  const baseURL = 'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxa7e710795d5adeb3&redirect_uri=https%3A%2F%2Fh5.xiaoguai.net%2Flogin%2F%3Fref%3D';
  const url = baseURL + encodeURIComponent(ref) + '&response_type=code&scope=snsapi_base#wechat_redirect';
  
  const typeNumber = 0;
  const errorCorrectionLevel = 'L';
  const qr = qrcode(typeNumber, errorCorrectionLevel);
  qr.addData(url);
  qr.make();
  
  const canvas = document.getElementById('qrCodeCanvas');
  const ctx = canvas.getContext('2d');
  
  const img = new Image();
  img.onload = function() {
    ctx.drawImage(img, 0, 0);
    
    const qrCodeSize = 508;
    const qrCodeX = 87;
    const qrCodeY = 87;
    
    const qrCodeCanvas = document.createElement('canvas');
    qrCodeCanvas.width = qrCodeSize;
    qrCodeCanvas.height = qrCodeSize;
    const qrCodeCtx = qrCodeCanvas.getContext('2d');
    
    // 设置二维码的颜色
    const darkColor = '#000000';
    const lightColor = '#FFFFFF';
    
    qr.renderTo2dContext(qrCodeCtx, qrCodeSize, darkColor, lightColor);
    
    ctx.drawImage(qrCodeCanvas, qrCodeX, qrCodeY);
  };
  img.src = 'erwema.jpg';
}
  </script>
</body>
</html>
